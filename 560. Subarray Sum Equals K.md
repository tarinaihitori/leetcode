1st
二重ループを思いついたが、TLE が発生。
時間計算量：O(n^2)
空間計算量：O(1)

```python
class Solution:
    def subarraySum(self, nums: List[int], k: int) -> int:
        count = 0

        for i in range(len(nums)):
            total = 0
            for j in range(i, len(nums)):
                total += nums[j]
                if total == k:
                    count += 1
        return count
```

回答を見た。
時間計算量：O(n)
空間計算量：O(n)

```python
class Solution:
    def subarraySum(self, nums: List[int], k: int) -> int:
        count = 0
        cumulative_sum = 0
        prefix_sums = {0: 1}

        for num in nums:
            cumulative_sum += num
            if cumulative_sum - k in prefix_sums:
                count += prefix_sums[cumulative_sum - k]
            if cumulative_sum not in prefix_sums:
                prefix_sums[cumulative_sum] = 0
            prefix_sums[cumulative_sum] += 1
        return count
```

2nd
1st を読みやすくする。defaultdict を使えば if 文は消せる。
python の場合は数値は勝手に拡張されるので、prefix_sum がオーバーフローすることは考慮しなくてよい。
https://docs.python.org/3/c-api/long.html

```python
class Solution:
    def subarraySum(self, nums: List[int], k: int) -> int:
        prefix_sums = defaultdict(int)
        prefix_sums[0] = 1
        prefix_sum = 0
        count = 0
        for num in nums:
            prefix_sum += num
            count += prefix_sums[prefix_sum - k]
            prefix_sums[prefix_sum] += 1
        return count
```

defaultdict を使わずに通常の辞書を使う版
get メソッドを使うことで、キーが存在しない場合にデフォルト値として 0 を返してキーエラーを防いでいる点が異なる。
https://docs.python.org/3.13/library/stdtypes.html#dict.get
これなら、やはり defaultdict のほうが簡潔で読みやすいと思う。

```python
class Solution:
    def subarraySum(self, nums: List[int], k: int) -> int:
        prefix_sums = {0:1}
        prefix_sum = 0
        count = 0
        for num in nums:
            prefix_sum += num
            count += prefix_sums.get(prefix_sum - k, 0)
            prefix_sums[prefix_sum] = prefix_sums.get(prefix_sum, 0) + 1
        return count
```

3rd
2nd の defaultdict と同じ

```python
class Solution:
    def subarraySum(self, nums: List[int], k: int) -> int:
        prefix_sums = defaultdict(int)
        prefix_sums[0] = 1
        prefix_sum = 0
        count = 0
        for num in nums:
            prefix_sum += num
            count += prefix_sums[prefix_sum - k]
            prefix_sums[prefix_sum] += 1
        return count
```
